########  ##     ## ##    ## ######## ########
##     ## ##     ##  ##  ##  ##       ##     ##
##     ## ##     ##   ####   ##       ##     ##
########  ##     ##    ##    ######   ########
##     ## ##     ##    ##    ##       ##   ##
##     ## ##     ##    ##    ##       ##    ##
########   #######     ##    ######## ##     ##

###############################################################################
# Buyer :: Totals
###############################################################################

item_views:
  title: item_views
  tags: [i2, bx, total]
  numerator: [item_views]
  agg: sum

contacts:
  numerator: [phone_views_total, booking_created_short_rent, first_messages, delivery_order_created]
  tags: [i1, bx, total]
  agg: sum

advertisement_page_views:
  title: advertisement_page_views
  tags: [critical, rise, ad, total]
  numerator: [advertisement_page_views]
  agg: sum

phone_views_snippet:
  title: phone_views_snippet
  tags: [i3, bx, total]
  numerator: [phone_views_snippet, phone_views_snippet_xlvas]
  agg: sum

phone_views:
  title: phone_views
  tags: [i2, bx, total]
  numerator: [phone_views_item_right, phone_views_item_top]
  agg: sum

phone_views_total:
  title: phone_views_total
  tags: [i3, bx, total]
  numerator: [phone_views_total]
  agg: sum

favorites_added:
  title: favorites_added
  tags: [i2, bx, fav, total]
  numerator: [favorites_added]
  agg: sum

first_messages:
  title: first_messages
  tags: [i2, bx, mes, total]
  numerator: [first_messages]
  agg: sum

all_main_pages:
  title: all_main_pages
  tags: [i2, bx, rec, main, total]
  numerator: [head_main_pages, transport_main_pages, re_main_pages, services_main_pages]
  agg: sum

head_main_pages:
  title: head_main_pages
  tags: [i2, bx, rec, main, total]
  numerator: [head_main_pages]
  agg: sum

vertical_main_pages:
  title: vertical_main_pages
  tags: [i4, bx, rec, main, total]
  numerator: [transport_main_pages, re_main_pages, services_main_pages]
  agg: sum

transport_main_pages:
  title: transport_main_pages
  tags: [i4, bx, rec, main, total]
  numerator: [transport_main_pages]
  agg: sum

re_main_pages:
  title: re_main_pages
  tags: [i4, bx, rec, main, total]
  numerator: [re_main_pages]
  agg: sum

services_main_pages:
  title: services_main_pages
  tags: [i4, bx, rec, main, total]
  numerator: [services_main_pages]
  agg: sum

bt_clicks:
  title: bt_clicks
  tags: [i1, bx, total]
  numerator: [phone_views_total, first_messages, delivery_order_created, booking_created_short_rent, favorites_added,write_button_clicks]
  agg: sum

###############################################################################
# Buyer :: Ratios
###############################################################################

phone_views_per_item_view:
  title: phone_views_per_item_view
  tags: [i3, bx, ratio]
  agg: sum
  numerator: [phone_views_item_right, phone_views_item_top]
  denominator: [item_views]

contacts_per_item_view:
  title: contacts_per_item_view
  tags: [i2, bx, ratio]
  agg: sum
  numerator: [phone_views_item_right, phone_views_item_top, booking_created_short_rent, first_messages, delivery_order_created]
  denominator: [item_views]

delivery_orders_per_flow_begining:
  agg: sum
  numerator: [delivery_order_created]
  denominator: [delivery_flow_beginings]

###############################################################################
# Buyer :: User Totals
###############################################################################

users_active_daily:
  title: users_active
  tags: [critical, bx, user]
  numerator:
    - item_views
    - phone_views_total
    - first_messages
    - booking_created_short_rent
    - delivery_flow_beginings
    - delivery_order_created
    - searches_without_query
    - searches_with_query
    - favorites_added
  agg: proportion

users_item_view_daily:
  title: users_item_view
  tags: [i1, bx, user]
  numerator: [item_views]
  agg: proportion

buyers:
  title: buyers
  tags: [i0, bx, user]
  numerator: [phone_views_total, booking_created_short_rent, first_messages, delivery_order_created]
  agg: proportion

users_all_main_page_daily:
  title: users_main_page
  tags: [i2, bx, rec, main, user]
  numerator: [head_main_pages, transport_main_pages, re_main_pages, services_main_pages]
  agg: proportion

users_head_main_page_daily:
  title: users_head_main_page
  tags: [i2, bx, rec, main, user]
  numerator: [head_main_pages]
  agg: proportion

users_transport_main_page_daily:
  title: users_transport_main_page
  tags: [i4, bx, rec, main, user]
  numerator: [transport_main_pages]
  agg: proportion

users_re_main_page_daily:
  title: users_re_main_page
  tags: [i4, bx, rec, main, user]
  numerator: [re_main_pages]
  agg: proportion

users_services_main_page_daily:
  title: users_services_main_page
  tags: [i4, bx, rec, main, user]
  numerator: [services_main_pages]
  agg: proportion

users_vertical_main_page_daily:
  title: users_vertical_main_page
  tags: [i3, bx, rec, main, user]
  numerator: [transport_main_pages, re_main_pages, services_main_pages]
  agg: proportion

users_bt_click_daily:
  title: users_bt_click
  tags: [i0, bx, user]
  numerator: [phone_views_total, first_messages, booking_created_short_rent, delivery_order_created, favorites_added]
  agg: proportion

users_favorites:
  title: users_favorites
  tags: [i0, bx, user]
  numerator: [favorites_added]
  agg: proportion
  groupby: [participant]

###############################################################################
# Buyer :: Sessions Totals
###############################################################################

sessions_favorites:
  title: sessions_favorites
  tags: [i0, bx, user]
  numerator: [fav_added_serp, fav_added_rec]
  agg: proportion
  groupby: [participant, session]

###############################################################################
# Buyer :: User Ratios
###############################################################################

buyers_per_users:
  title: buyers_per_users
  tags: [i0, bx, ratio]
  agg: proportion
  numerator: [phone_views_total, booking_created_short_rent, first_messages, delivery_order_created]
  denominator:
    - item_views
    - phone_views_total
    - first_messages
    - booking_created_short_rent
    - delivery_flow_beginings
    - delivery_order_created
    - searches_without_query
    - searches_with_query
    - favorites_added

users_item_view_per_users:
  title: users_item_view_per_users
  tags: [i1, bx, ratio]
  agg: proportion
  numerator: [item_views]
  denominator:
    - item_views
    - phone_views_total
    - first_messages
    - booking_created_short_rent
    - delivery_flow_beginings
    - delivery_order_created
    - searches_without_query
    - searches_with_query
    - favorites_added

users_bt_click_per_users:
  title: users_bt_click_per_users
  tags: [i1, bx, ratio]
  agg: proportion
  numerator: [phone_views_total, first_messages, booking_created_short_rent, delivery_order_created, favorites_added]
  denominator:
    - item_views
    - phone_views_total
    - first_messages
    - booking_created_short_rent
    - delivery_flow_beginings
    - delivery_order_created
    - searches_without_query
    - searches_with_query
    - favorites_added

buyers_per_users_favorites:
  title: buyers_per_users_favorites
  tags: [i1, bx, ratio]
  agg: proportion
  numerator: [phone_views_total, booking_created_short_rent, first_messages, delivery_order_created]
  denominator: [favorites_added]

###############################################################################
# Buyer :: Other
###############################################################################

favorites_removed:
  title: favorites_removed
  tags: [i4, bx, fav, total]
  numerator: [favorites_removed]
  agg: sum

favorites_list_views:
  title: favorites_list_views
  tags: [i4, bx, fav, total]
  numerator: [favorites_list_views]
  agg: sum

saved_searches_added:
  title: saved_searches_added
  tags: [i4, bx, ss, total]
  numerator: [saved_searches_added]
  agg: sum

loc_window_opens:
  title: loc_window_opens
  tags: [i4, bx, total]
  numerator: [location_window_displays]
  agg: sum

location_text_inputs:
  title: location_text_inputs
  tags: [i4, bx, total]
  numerator: [location_text_inputs]
  agg: sum

loc_window_saves_per_opens:
  title: loc_window_saves_per_opens
  tags: [i4, bx, total]
  agg: sum
  numerator: [location_window_save_clicks]
  denominator: [location_window_displays]

loc_suggests_per_text_inputs:
  title: loc_suggests_per_text_inputs
  tags: [i4, bx, total]
  agg: sum
  numerator: [location_suggest_clicks]
  denominator: [location_text_inputs]

users_loc_window_opens:
  title: users_loc_window_opens
  tags: [i4, bx,  user]
  numerator: [location_window_displays]
  agg: proportion

users_loc_suggest_clicks:
  title: users_loc_suggest_clicks
  tags: [i4, bx,  user]
  numerator: [location_suggest_clicks]
  agg: proportion

searches_and_item_views_to_contact:
  title: siv_to_contact
  tags: [i3, bx]
  numerator: [searches_and_iv_to_contact]
  agg: sum

ad_pages_to_contact:
  title: ad_pages_to_contact
  tags: [i3, bx]
  numerator: [ad_pages_to_contact]
  agg: sum

item_views_to_contact:
  title: iv_to_contact
  tags: [i3, bx]
  numerator: [item_views_to_contact]
  agg: sum

searches_to_contact:
  title: searches_to_contact
  tags: [i3, bx]
  numerator: [searches_to_contact]
  agg: sum

###############################################################################
# Buyer :: Performance (Time To Content) Ratios
###############################################################################

mean_time_to_content_item_screen:
  tags: [bx, performance, item, ttc, ratio]
  agg: sum
  numerator: [performance_time_to_content_item]
  denominator: [performance_measures_count_item]

mean_time_to_content_serp_screen:
  tags: [bx, performance, serp, ttc, ratio]
  agg: sum
  numerator: [performance_time_to_content_serp]
  denominator: [performance_measures_count_serp]

mean_time_to_content_main_screen:
  tags: [bx, performance, main, ttc, ratio]
  agg: sum
  numerator: [performance_time_to_content_main]
  denominator: [performance_measures_count_main]

mean_time_to_content_channel_screen:
  tags: [bx, performance, channel, ttc, ratio]
  description: "mean time to content evaluation for chatting screen"
  agg: sum
  numerator: [performance_time_to_content_channel]
  denominator: [performance_measures_count_channel]

mean_time_to_content_channels_screen:
  tags: [bx, performance, channels, ttc, ratio]
  description: "mean time to content evaluation for screen with list of chats"
  agg: sum
  numerator: [performance_time_to_content_channels]
  denominator: [performance_measures_count_channels]

mean_time_to_content_public_profile_screen:
  tags: [bx, performance, public_profile, ttc, ratio]
  agg: sum
  numerator: [performance_time_to_content_public_profile]
  denominator: [performance_measures_count_public_profile]

mean_time_to_content_profile_item_screen:
  tags: [bx, performance, profile_item, ttc, ratio]
  agg: sum
  numerator: [performance_time_to_content_profile_item]
  denominator: [performance_measures_count_profile_item]

mean_time_to_content_account_screen:
  tags: [bx, performance, account, ttc, ratio]
  description: "mean time to content evaluation for screen with list of users items"
  agg: sum
  numerator: [performance_time_to_content_account]
  denominator: [performance_measures_count_account]

mean_time_to_content_favorite_items_screen:
  tags: [bx, performance, favorite_items, ttc, ratio]
  agg: sum
  numerator: [performance_time_to_content_favorite_items]
  denominator: [performance_measures_count_favorite_items]

mean_time_to_content_other_screen:
  tags: [bx, performance, other, ttc, ratio]
  agg: sum
  numerator: [
      performance_time_to_content_publish_wizard,
      performance_time_to_content_edit_item,
      performance_time_to_content_authorization,
      performance_time_to_content_shop_info,
      performance_time_to_content_profile,
      performance_time_to_content_shops_list]
  denominator: [
      performance_measures_count_publish_wizard,
      performance_measures_count_edit_item,
      performance_measures_count_authorization,
      performance_measures_count_shop_info,
      performance_measures_count_profile,
      performance_measures_count_shops_list]

mean_screen_exception_proba:
  tags: [bx, performance, exception, ttc, ratio]
  agg: sum
  numerator: [
      performance_exceptions_count_item,
      performance_exceptions_count_serp,
      performance_exceptions_count_main,
      performance_exceptions_count_channel,
      performance_exceptions_count_channels,
      performance_exceptions_count_public_profile,
      performance_exceptions_count_profile_item,
      performance_exceptions_count_account,
      performance_exceptions_count_publish_wizard,
      performance_exceptions_count_edit_item,
      performance_exceptions_count_authorization,
      performance_exceptions_count_shop_info,
      performance_exceptions_count_profile,
      performance_exceptions_count_shops_list]
  denominator: [
      performance_events_count_item,
      performance_events_count_serp,
      performance_events_count_main,
      performance_events_count_channel,
      performance_events_count_channels,
      performance_events_count_public_profile,
      performance_events_count_profile_item,
      performance_events_count_account,
      performance_events_count_publish_wizard,
      performance_events_count_edit_item,
      performance_events_count_authorization,
      performance_events_count_shop_info,
      performance_events_count_profile,
      performance_events_count_shops_list]

 ######  ########    ###    ########   ######  ##     ##
##    ## ##         ## ##   ##     ## ##    ## ##     ##
##       ##        ##   ##  ##     ## ##       ##     ##
 ######  ######   ##     ## ########  ##       #########
      ## ##       ######### ##   ##   ##       ##     ##
##    ## ##       ##     ## ##    ##  ##    ## ##     ##
 ######  ######## ##     ## ##     ##  ######  ##     ##

###############################################################################
# Search :: Totals
###############################################################################

searches_date_sort:
  tags: [i3, bx, total]
  numerator: [searches_date_sort]
  agg: sum

searches_with_query_date_sort:
  tags: [i3, bx, total]
  numerator: [searches_with_query_date_sort]
  agg: sum

searches_without_query_date_sort:
  tags: [i3, bx, total]
  numerator: [searches_without_query_date_sort]
  agg: sum

searches_with_query:
  title: searches_with_query
  tags: [i3, bx, total]
  numerator: [searches_with_query]
  agg: sum

searches_without_query:
  title: searches_without_query
  tags: [i3, bx, total]
  numerator: [searches_without_query]
  agg: sum

searches:
  title: searches
  tags: [i2, bx, total]
  numerator: [searches]
  agg: sum
  description: only first page

searches_new:
  title: searches_new
  tags: [i2, bx, total]
  numerator: [searches]
  groupby: []
  description: only first page

searches_serp:
  title: searches_serp
  tags: [i2, bx, total]
  numerator: [searches_serp]
  agg: sum
  description: all pages included

serp_empty:
  title: serp_empty
  tags: [i2, bx, serp, total]
  numerator: [serp_empty]
  agg: sum

serp_small:
  title: serp_small
  tags: [i2, bx, serp, total]
  numerator: [serp_small]
  agg: sum

searches_item_view_vip:
  title: searches_item_view_vip
  tags: [i4, bx, serp, vas, has]
  numerator: [searches_item_view_vip]
  agg: sum

searches_item_view_premium:
  title: searches_item_view_premium
  tags: [i4, bx, serp, vas, has]
  numerator: [searches_item_view_premium]
  agg: sum

searches_item_view_push:
  title: searches_item_view_push
  tags: [i4, bx, serp, vas, has]
  numerator: [searches_item_view_push]
  agg: sum

searches_item_view_vas:
  title: searches_item_view_vas
  tags: [i3, bx, serp, vas, has]
  numerator: [searches_item_view_vas]
  agg: sum

searches_item_view_serp:
  title: searches_item_view_serp
  tags: [i3, bx, serp, has]
  numerator: [searches_item_view_serp]
  agg: sum

shows_item_view_recblock:
  title: shows_item_view_recblock
  tags: [i3, bx, rec, has]
  numerator: [shows_item_view_recblock]
  agg: sum

searches_contact_vip:
  title: searches_contact_vip
  tags: [i4, bx, serp, vas, has]
  numerator: [searches_contact_vip]
  agg: sum

searches_contact_premium:
  title: searches_contact_premium
  tags: [i4, bx, serp, vas, has]
  numerator: [searches_contact_premium]
  agg: sum

searches_contact_push:
  title: searches_contact_push
  tags: [i4, bx, serp, vas, has]
  numerator: [searches_contact_push]
  agg: sum

searches_contact_vas:
  title: searches_contact_vas
  tags: [i4, bx, serp, vas, has]
  numerator: [searches_contact_vas]
  agg: sum

searches_contact_serp:
  title: searches_contact_serp
  tags: [i4, bx, serp, has]
  numerator: [searches_contact_serp]
  agg: sum

shows_contact_recblock:
  title: shows_contact_recblock
  tags: [i3, bx, rec, has]
  numerator: [shows_contact_recblock]
  agg: sum

item_views_vip:
  title: item_views_vip
  tags: [bx, vas, total]
  numerator: [item_views_vip]
  agg: sum

item_views_premium:
  title: item_views_premium
  tags: [bx, vas, total]
  numerator: [item_views_premium]
  agg: sum

item_views_push:
  title: item_views_push
  tags: [bx, vas, total]
  numerator: [item_views_push]
  agg: sum

item_views_vas:
  title: item_views_vas
  tags: [critical, bx, vas, total]
  numerator: [item_views_vas]
  agg: sum

item_views_serp:
  title: item_views_serp
  tags: [i2, bx, serp, total]
  numerator: [item_views_serp]
  agg: sum

contacts_vip:
  title: contacts_vip
  tags: [bx, vas, total]
  numerator: [contacts_vip]
  agg: sum

contacts_premium:
  title: contacts_premium
  tags: [bx, vas, total]
  numerator: [contacts_premium]
  agg: sum

contacts_push:
  title: contacts_push
  tags: [i4, bx, vas, total]
  numerator: [contacts_push]
  agg: sum

contacts_vas:
  title: contacts_vas
  tags: [i3, bx, vas, total]
  numerator: [contacts_vas]
  agg: sum

contacts_serp:
  title: contacts_serp
  tags: [i2, bx, serp, total]
  numerator: [contacts_serp]
  agg: sum

contacts_rec:
  title: contacts_rec
  tags: [i2, bx, rec, total]
  numerator: [contacts_rec]
  agg: sum

fav_added_vip:
  title: fav_added_vip
  tags: [bx, vas, fav, total]
  numerator: [fav_added_vip]
  agg: sum

fav_added_premium:
  title: fav_added_premium
  tags: [bx, vas, fav, total]
  numerator: [fav_added_premium]
  agg: sum

fav_added_push:
  title: fav_added_push
  tags: [i4, bx, vas, fav, total]
  numerator: [fav_added_push]
  agg: sum

fav_added_vas:
  title: fav_added_vas
  tags: [i4, bx, vas, fav, total]
  numerator: [fav_added_vas]
  agg: sum

fav_added_serp:
  title: fav_added_serp
  tags: [i2, bx, serp, fav, total]
  numerator: [fav_added_serp]
  agg: sum

fav_added_rec:
  title: fav_added_rec
  tags: [i2, bx, rec, fav, total]
  numerator: [fav_added_rec]
  agg: sum

buyer_target_clicks_vip:
  title: bt_clicks_vip
  tags: [i4, bx, serp, vas, total]
  numerator: [buyer_target_clicks_vip]
  agg: sum

buyer_target_clicks_premium:
  title: bt_clicks_premium
  tags: [bx, vas, total]
  numerator: [buyer_target_clicks_premium]
  agg: sum

buyer_target_clicks_push:
  title: bt_clicks_push
  tags: [bx, vas, total]
  numerator: [buyer_target_clicks_push]
  agg: sum

buyer_target_clicks_vas:
  title: bt_clicks_vas
  tags: [critical, bx, vas, total]
  numerator: [buyer_target_clicks_vas]
  agg: sum

buyer_target_clicks_serp:
  title: bt_clicks_serp
  tags: [i2, bx, serp, total]
  numerator: [buyer_target_clicks_serp]
  agg: sum

buyer_target_clicks_rec:
  title: bt_clicks_rec
  tags: [i2, bx, rec, total]
  numerator: [buyer_target_clicks_rec]
  agg: sum

suggest_buyers:
  description: "Buyers, who use suggest"
  tags: [ss, sgt]
  agg: proportion
  numerator: [queries_no_redirect_contact]

###############################################################################
# Search :: Ratios
###############################################################################

item_views_vip_per_search:
  title: item_views_vip_per_search
  tags: [bx, vas, ratio]
  agg: sum
  numerator: [item_views_vip]
  denominator: [searches_serp]

item_views_premium_per_search:
  title: item_views_premium_per_search
  tags: [bx, vas, ratio]
  agg: sum
  numerator: [item_views_premium]
  denominator: [searches_serp]

item_views_push_per_search:
  title: item_views_push_per_search
  tags: [bx, vas, ratio]
  agg: sum
  numerator: [item_views_push]
  denominator: [searches_serp]

item_views_vas_per_search:
  title: item_views_vas_per_search
  tags: [i4, bx, serp, vas, ratio]
  agg: sum
  numerator: [item_views_vas]
  denominator: [searches_serp]

item_views_serp_per_search:
  title: item_views_serp_per_search
  tags: [i2, bx, serp, ratio]
  agg: sum
  numerator: [item_views_serp]
  denominator: [searches_serp]

item_views_rec_per_rec_block:
  title: item_views_rec_per_recblock
  tags: [i4, bx, rec, ratio]
  agg: sum
  numerator: [item_views_rec]
  denominator: [recblock_shows]

contacts_vip_per_search:
  title: contacts_vip_per_search
  tags: [bx, vas, ratio]
  agg: sum
  numerator: [contacts_vip]
  denominator: [searches_serp]

contacts_premium_per_search:
  title: contacts_premium_per_search
  tags: [bx, vas, ratio]
  agg: sum
  numerator: [contacts_premium]
  denominator: [searches_serp]

contacts_push_per_search:
  title: contacts_push_per_search
  tags: [bx, vas, ratio]
  agg: sum
  numerator: [contacts_push]
  denominator: [searches_serp]

contacts_vas_per_search:
  title: contacts_vas_per_search
  tags: [i4, bx, serp, vas, ratio]
  agg: sum
  numerator: [contacts_vas]
  denominator: [searches_serp]

contacts_serp_per_search:
  title: contacts_serp_per_search
  tags: [i3, bx, serp, ratio]
  agg: sum
  numerator: [contacts_serp]
  denominator: [searches_serp]

fav_added_vip_per_search:
  title: fav_added_vip_per_search
  tags: [bx, vas, fav, ratio]
  agg: sum
  numerator: [fav_added_vip]
  denominator: [searches_serp]

fav_added_premium_per_search:
  title: fav_added_premium_per_search
  tags: [bx, vas, fav, ratio]
  agg: sum
  numerator: [fav_added_premium]
  denominator: [searches_serp]

fav_added_push_per_search:
  title: fav_added_push_per_search
  tags: [bx, vas, fav, ratio]
  agg: sum
  numerator: [fav_added_push]
  denominator: [searches_serp]

fav_added_vas_per_search:
  title: fav_added_vas_per_search
  tags: [bx, vas, fav, ratio]
  agg: sum
  numerator: [fav_added_vas]
  denominator: [searches_serp]

fav_added_serp_per_search:
  title: fav_added_serp_per_search
  tags: [i4, bx, serp, fav, ratio]
  agg: sum
  numerator: [fav_added_serp]
  denominator: [searches_serp]

buyer_target_clicks_vip_per_search:
  title: bt_clicks_vip_per_search
  tags: [bx, vas, ratio]
  agg: sum
  numerator: [buyer_target_clicks_vip]
  denominator: [searches_serp]

buyer_target_clicks_premium_per_search:
  title: bt_clicks_premium_per_search
  tags: [bx, vas, ratio]
  agg: sum
  numerator: [buyer_target_clicks_premium]
  denominator: [searches_serp]

buyer_target_clicks_push_per_search:
  title: bt_clicks_push_per_search
  tags: [bx, vas, ratio]
  agg: sum
  numerator: [buyer_target_clicks_push]
  denominator: [searches_serp]

buyer_target_clicks_vas_per_search:
  title: bt_clicks_vas_per_search
  tags: [i4, bx, vas, ratio]
  agg: sum
  numerator: [buyer_target_clicks_vas]
  denominator: [searches_serp]

buyer_target_clicks_serp_per_search:
  title: bt_clicks_serp_per_search
  tags: [i2, bx, serp, ratio]
  agg: sum
  numerator: [buyer_target_clicks_serp]
  denominator: [searches_serp]

contacts_vip_per_item_views_vip:
  title: contacts_vip_per_item_views_vip
  tags: [bx, vas, ratio]
  agg: sum
  numerator: [contacts_vip]
  denominator: [item_views_vip]

contacts_premium_per_item_views_premium:
  title: contacts_premium_per_item_views_premium
  tags: [bx, vas, ratio]
  agg: sum
  numerator: [contacts_premium]
  denominator: [item_views_premium]

contacts_push_per_item_views_push:
  title: contacts_push_per_item_views_push
  tags: [bx, vas, ratio]
  agg: sum
  numerator: [contacts_push]
  denominator: [item_views_push]

contacts_vas_per_item_views_vas:
  title: contacts_vas_per_item_views_vas
  tags: [i4, bx, vas, ratio]
  agg: sum
  numerator: [contacts_vas]
  denominator: [item_views_vas]

contacts_serp_per_item_views_serp:
  title: contacts_serp_per_item_views_serp
  tags: [i2, bx, serp, ratio]
  agg: sum
  numerator: [contacts_serp]
  denominator: [item_views_serp]

searches_item_view_serp_per_searches_serp:
  title: searches_item_view_serp_per_searches
  tags: [i2, bx, serp, ratio]
  agg: sum
  numerator: [searches_item_view_serp]
  denominator: [searches_serp]

searches_with_suggest_share:
  description: "Share of searches with suggest"
  tags: [ss, ratio, sgt]
  agg: sum
  numerator: [queries_with_suggest]
  denominator: [queries_no_redirect]

###############################################################################
# Search :: User Totals
###############################################################################

users_search:
  title: users_search
  tags: [i2, bx, serp, user]
  numerator: [searches]
  agg: proportion

users_search_new:
  title: users_search_new
  tags: [i2, bx, serp, user]
  numerator: [searches]
  groupby: [participant]

users_search_session_new:
  title: users_search_session_new
  tags: [i2, bx, serp, user]
  numerator: [searches]
  groupby: [participant, session]

users_search_query:
  title: users_search_query
  tags: [i2, bx, serp, user]
  numerator: [searches_with_query]
  agg: proportion

users_item_view_serp_daily:
  title: users_search_item_view
  tags: [i2, bx, serp, user]
  numerator: [item_views_serp]
  agg: proportion

users_item_view_search_query:
  tags: [i2, bx, serp, user]
  numerator: [searches_query_item_view]
  agg: proportion

users_contact_serp_daily:
  title: users_search_contact
  tags: [i1, bx, serp, user]
  numerator: [contacts_serp]
  agg: proportion

users_buyer_target_click_serp_daily:
  title: users_search_bt_click
  tags: [i1, bx, serp, user]
  numerator: [buyer_target_clicks_serp]
  agg: proportion

users_contact_search_query:
  tags: [i2, bx, serp, user]
  numerator: [searches_query_contact]
  agg: proportion

###############################################################################
# Search :: User Ratios
###############################################################################

users_item_view_per_search:
  tags: [i2, bx, serp, user]
  numerator: [item_views_serp]
  denominator: [searches]
  agg: proportion

users_contact_per_search:
  tags: [i2, bx, serp, user]
  numerator: [contacts_serp]
  denominator: [searches]
  agg: proportion

users_contact_per_item_view_search:
  tags: [i2, bx, serp, user]
  numerator: [contacts_serp]
  denominator: [item_views_serp]
  agg: proportion

users_item_view_per_search_query:
  tags: [i2, bx, serp, user]
  numerator: [searches_query_item_view]
  denominator: [searches_with_query]
  agg: proportion

users_contact_per_search_query:
  tags: [i2, bx, serp, user]
  numerator: [searches_query_contact]
  denominator: [searches_with_query]
  agg: proportion

suggest_users_share:
  description: "Share of cookies, who use suggest"
  tags: [ss, sgt, ratio]
  agg: proportion
  numerator: [queries_with_suggest]
  denominator: [queries_no_redirect]

suggest_buyers_share:
  description: "Share of buyers, who use suggest, to cookies, who use suggest"
  tags: [ss, sgt, ratio]
  agg: proportion
  numerator: [queries_no_redirect_contact]
  denominator: [queries_with_suggest]


########  ########  ######
##     ## ##       ##    ##
##     ## ##       ##
########  ######   ##
##   ##   ##       ##
##    ##  ##       ##    ##
##     ## ########  ######

###############################################################################
# Rec :: Totals
###############################################################################

recblock_shows:
  numerator: [recblock_shows]
  agg: sum

item_views_rec:
  title: item_views_rec
  tags: [i2, bx, rec, total]
  numerator: [item_views_rec]
  agg: sum

item_views_rec_i2i:
  title: item_views_rec_i2i
  tags: [i3, bx, rec, total]
  numerator: [item_views_rec_i2i]
  agg: sum

item_views_rec_u2i:
  title: item_views_rec_u2i
  tags: [i3, bx, rec, total]
  numerator: [item_views_rec_u2i]
  agg: sum

contacts_rec_i2i:
  title: contacts_rec_i2i
  tags: [i2, bx, rec, total]
  numerator: [contacts_rec_i2i]
  agg: sum

contacts_rec_u2i:
  title: contacts_rec_u2i
  tags: [i2, bx, rec, total]
  numerator: [contacts_rec_u2i]
  agg: sum

fav_added_rec_i2i:
  title: fav_added_rec_i2i
  tags: [i3, bx, rec, total]
  numerator: [fav_added_rec_i2i]
  agg: sum

fav_added_rec_u2i:
  title: fav_added_rec_u2i
  tags: [i3, bx, rec, total]
  numerator: [fav_added_rec_u2i]
  agg: sum

buyer_target_clicks_rec_i2i:
  title: bt_clicks_rec_i2i
  tags: [i2, bx, rec, total]
  numerator: [buyer_target_clicks_rec_i2i]
  agg: sum

buyer_target_clicks_rec_u2i:
  title: bt_clicks_rec_u2i
  tags: [i2, bx, rec, total]
  numerator: [buyer_target_clicks_rec_u2i]
  agg: sum

item_views_auto_almost_new_net:
  tags: [i4, bx]
  agg: sum
  numerator: [item_views_auto_almost_new_net]

contacts_auto_almost_new_net:
  tags: [i4, bx]
  agg: sum
  numerator: [contacts_auto_almost_new_net]

buyers_auto_almost_new:
  tags: [i4, bx]
  agg: proportion
  numerator: [contacts_auto_almost_new_net]

favorites_added_auto_almost_new:
  title: fav_auto_almost_new
  tags: [i4, bx]
  agg: sum
  numerator: [favorites_added_auto_almost_new]

###############################################################################
# Rec :: Ratios
###############################################################################

contacts_rec_per_rec_block:
  title: contacts_rec_per_recblock
  tags: [i3, bx, rec, ratio]
  agg: sum
  numerator: [contacts_rec]
  denominator: [recblock_shows]

fav_added_rec_per_rec_block:
  title: fav_added_rec_per_recblock
  tags: [i4, bx, rec, fav, ratio]
  agg: sum
  numerator: [fav_added_rec]
  denominator: [recblock_shows]

buyer_target_clicks_rec_per_rec_block:
  title: bt_clicks_rec_per_recblock
  tags: [i3, bx, rec, ratio]
  agg: sum
  numerator: [buyer_target_clicks_rec]
  denominator: [recblock_shows]

contacts_rec_per_item_views_rec:
  title: contacts_rec_per_item_views_rec
  tags: [i3, bx, rec, ratio]
  agg: sum
  numerator: [contacts_rec]
  denominator: [item_views_rec]

shows_item_view_recblock_per_recblock_shows:
  title: shows_item_view_recblock_per_recblock_shows
  tags: [i3, bx, rec, ratio]
  agg: sum
  numerator: [shows_item_view_recblock]
  denominator: [recblock_shows]

###############################################################################
# Rec :: User Totals
###############################################################################

users_item_view_rec_daily:
  title: users_item_view_rec
  tags: [i3, bx, rec, user]
  numerator: [item_views_rec]
  agg: proportion

users_contact_rec_daily:
  title: users_contact_rec
  tags: [i1, bx, rec, user]
  numerator: [contacts_rec]
  agg: proportion

users_buyer_target_click_rec_daily:
  title: users_bt_click_rec
  tags: [i2, bx, rec, user]
  numerator: [buyer_target_clicks_rec]
  agg: proportion

users_contact_rec_i2i:
  title: users_contact_rec_i2i
  tags: [i2, bx, rec, user]
  numerator: [contacts_rec_i2i]
  agg: proportion

users_contact_rec_u2i:
  title: users_contact_rec_u2i
  tags: [i2, bx, rec, user]
  numerator: [contacts_rec_u2i]
  agg: proportion

users_item_view_rec_i2i:
  title: users_item_view_rec_i2i
  tags: [i3, bx, rec, user]
  numerator: [item_views_rec_i2i]
  agg: proportion

users_item_view_rec_u2i:
  title: users_item_view_rec_u2i
  tags: [i3, bx, rec, user]
  numerator: [item_views_rec_u2i]
  agg: proportion

###############################################################################
# Rec :: User Ratios
###############################################################################

users_item_views_rec_u2i_per_users_all_main_pages:
  title: u2i_viewers_per_visitors
  description: "Conversion from unique visitors to uniqie viewers on main page recommendations"
  tags: [i3, bx, rec, main, ratio]
  numerator: [item_views_rec_u2i]
  denominator: [head_main_pages, transport_main_pages, re_main_pages, services_main_pages]
  agg: proportion

users_item_views_rec_i2i_per_users_item_views:
  title: i2i_viewers_per_visitors
  description: "Conversion from unique visitors to uniqie viewers on item page recommendations"
  tags: [i3, bx, rec, ratio]
  numerator: [item_views_rec_i2i]
  denominator: [item_views]
  agg: proportion

users_contacts_rec_u2i_per_users_all_main_pages:
  title: u2i_buyers_per_visitors
  description: "Conversion from unique visitors to uniqie buyers on main page recommendations"
  tags: [i2, bx, rec, main, ratio]
  numerator: [contacts_rec_u2i]
  denominator: [head_main_pages, transport_main_pages, re_main_pages, services_main_pages]
  agg: proportion

users_contacts_rec_i2i_per_users_item_views:
  title: i2i_buyers_per_visitors
  description: "Conversion from unique visitors to uniqie buyers on item page recommendations"
  tags: [i2, bx, rec, ratio]
  numerator: [contacts_rec_i2i]
  denominator: [item_views]
  agg: proportion

users_contacts_rec_i2i_per_users_item_views_rec_i2i:
  title: i2i_buyers_per_viewers
  description: "Conversion from unique viewers to uniqie buyers on item page recommendations"
  tags: [i3, bx, rec, ratio]
  numerator: [contacts_rec_i2i]
  denominator: [item_views_rec_i2i]
  agg: proportion

users_contacts_rec_u2i_per_users_item_views_rec_u2i:
  title: u2i_buyers_per_viewers
  description: "Conversion from unique viewers to uniqie buyers on item page recommendations"
  tags: [i3, bx, rec, ratio]
  numerator: [contacts_rec_u2i]
  denominator: [item_views_rec_u2i]
  agg: proportion


##     ## ########  ######   ######  ######## ##    ##  ######   ######## ########
###   ### ##       ##    ## ##    ## ##       ###   ## ##    ##  ##       ##     ##
#### #### ##       ##       ##       ##       ####  ## ##        ##       ##     ##
## ### ## ######    ######   ######  ######   ## ## ## ##   #### ######   ########
##     ## ##             ##       ## ##       ##  #### ##    ##  ##       ##   ##
##     ## ##       ##    ## ##    ## ##       ##   ### ##    ##  ##       ##    ##
##     ## ########  ######   ######  ######## ##    ##  ######   ######## ##     ##

###############################################################################
# Messenger :: Totals
###############################################################################

phone_views_in_chat:
  title: phone_views_in_chat
  tags: [i3, messenger, total]
  numerator: [phone_views_in_chat]
  agg: sum

total_messages:
  title: total_messages
  tags: [i2, messenger, total]
  numerator: [messenger_total_messeges]
  agg: sum

write_button_clicks:
  title: write_button_clicks
  tags: [i3, messenger, total]
  numerator: [write_button_clicks]
  agg: sum

chats_deleted:
  title: chats_deleted
  tags: [i4, messenger, total]
  numerator: [messenger_chat_deleted]
  agg: sum

messenger_users_blocked:
  title: messenger_users_blocked
  tags: [i4, messenger, total]
  numerator: [messenger_users_blocked]
  agg: sum

item_views_from_messenger:
  title: item_views_from_messenger
  tags: [i3, messenger, total, web]
  numerator: [item_views_from_messenger]
  agg: sum

messenger_geo_messages:
  title: messenger_geo_messages
  tags: [i3, messenger, total]
  agg: sum
  numerator: [messenger_geo_messages]
  agg: sum

###############################################################################
# Messenger :: Ratios
###############################################################################

write_button_clicks_per_item_views:
  title: write_button_clicks_per_item_views
  tags: [i3, messenger, ratio]
  agg: sum
  numerator: [write_button_clicks]
  denominator: [item_views]

messenger_geo_conversion:
  title: messenger_geo_conversion
  tags: [i4, messenger, ratio, apps]
  agg: sum
  numerator: [geo_button_clicks]
  denominator: [attach_button_clicks]

messenger_send_text_conversion:
  title: messenger_send_text_conversion
  tags: [i4, messenger, ratio, web]
  agg: sum
  numerator: [total_text_send_button_clicks]
  denominator: [message_start_writing]

first_mess_per_write_button_clicks:
  title: first_mess_per_write_button_clicks
  tags: [i3, messenger, ratio]
  agg: sum
  numerator: [first_messages]
  denominator: [write_button_clicks]

###############################################################################
# Messenger :: proportion
###############################################################################

messenger_only_buyers:
  title: messenger_only_buyers
  tags: [i2, messenger, user]
  numerator: [first_messages]
  agg: proportion

messenger_visitors:
  title: messenger_visitors
  tags: [i2, messenger, user]
  numerator: [chat_list_views, chat_views]
  agg: proportion

messenger_dau:
  title: messenger_dau
  tags: [i2, messenger, user]
  numerator: [messenger_total_messeges]
  agg: proportion

########  ######## ##       #### ##     ## ######## ########  ##    ##
##     ## ##       ##        ##  ##     ## ##       ##     ##  ##  ##
##     ## ##       ##        ##  ##     ## ##       ##     ##   ####
##     ## ######   ##        ##  ##     ## ######   ########     ##
##     ## ##       ##        ##   ##   ##  ##       ##   ##      ##
##     ## ##       ##        ##    ## ##   ##       ##    ##     ##
########  ######## ######## ####    ###    ######## ##     ##    ##

###############################################################################
# Delivery :: Totals
###############################################################################

delivery_orders_created:
  title: delivery_orders_created
  tags: [i3, bx, total]
  numerator: [delivery_order_created]
  agg: sum

buyer_delivery_orders:
  title: buyer_delivery_orders
  description: "All delivery orders by buyer"
  tags: [i3, delivery, buyer]
  agg: sum
  numerator: [buyer_delivery_orders]

buyer_delivery_orders_with_pay:
  title: buyer_delivery_orders_with_pay
  description: "All delivery orders by buyer with pay"
  tags: [i3, delivery, buyer]
  agg: sum
  numerator: [buyer_delivery_orders_with_pay]

buyer_delivery_orders_in_transit:
  title: buyer_delivery_orders_in_transit
  description: "All delivery orders by buyer in transit"
  tags: [i3, delivery, buyer]
  agg: sum
  numerator: [buyer_delivery_orders_in_transit]

buyer_delivery_deals:
  title: buyer_delivery_deals
  description: "All delivery deals by buyer"
  tags: [i4, delivery, buyer]
  agg: sum
  numerator: [buyer_delivery_deals]

buyer_delivery_orders_expired:
  title: buyer_delivery_orders_expired
  description: "All delivery expired orders by buyer"
  tags: [i4, delivery, buyer]
  agg: sum
  numerator: [buyer_delivery_orders_expired]

buyer_delivery_orders_canceled:
  title: buyer_delivery_orders_canceled
  description: "All delivery canceled orders by buyer"
  tags: [i4, delivery, buyer]
  agg: sum
  numerator: [buyer_delivery_orders_canceled]

buyer_delivery_orders_returned:
  title: buyer_delivery_orders_returned
  description: "All delivery returned orders by buyer"
  tags: [i4, delivery, buyer]
  agg: sum
  numerator: [buyer_delivery_orders_returned]

seller_delivery_orders_returned:
  title: seller_delivery_orders_returned
  description: "All delivery returned order by seller"
  tags: [i4, delivery, seller]
  agg: sum
  numerator: [seller_delivery_orders_returned]

seller_delivery_deals:
  title: seller_delivery_deals
  description: "All delivery deals by seller"
  tags: [i3, delivery, seller]
  agg: sum
  numerator: [seller_delivery_deals]

seller_delivery_bonuses:
  title: seller_delivery_bonuses
  description: "Delivery bonuses by seller"
  tags: [i4, delivery, seller]
  agg: sum
  numerator: [seller_delivery_bonuses]

seller_delivery_orders_canceled:
  title: seller_delivery_orders_canceled
  description: "All delivery canceled orders by seller"
  tags: [i4, delivery, seller]
  agg: sum
  numerator: [seller_delivery_orders_canceled]

seller_delivery_orders_expired:
  title: seller_delivery_orders_expired
  description: "All delivery expired orders by seller"
  tags: [i4, delivery, seller]
  agg: sum
  numerator: [seller_delivery_orders_expired]

seller_delivery_orders_in_transit:
  title: seller_delivery_orders_in_transit
  description: "All delivery orders in transit by seller"
  tags: [i4, delivery, seller]
  agg: sum
  numerator: [seller_delivery_orders_in_transit]

seller_delivery_orders_with_pay:
  title: seller_delivery_orders_with_pay
  description: "All delivery order with pay by seller"
  tags: [i4, delivery, seller]
  agg: sum
  numerator: [seller_delivery_orders_with_pay]

helpdesk_vas_tag_tickets:
  title: helpdesk_vas_tag_tickets
  description: "Vas tickets"
  tags: [i4, delivery, vas, support]
  agg: sum
  numerator: [helpdesk_vas_tag_tickets]

helpdesk_delivery_tickets:
  title: helpdesk_delivery_tickets
  description: "Delivery tickets"
  tags: [i4, delivery, support]
  agg: sum
  numerator: [helpdesk_delivery_tickets]

helpdesk_delivery_vas_tickets:
  title: helpdesk_delivery_vas_tickets
  description: "Delivery vas tickets"
  tags: [i4, delivery, support,vas]
  agg: sum
  numerator: [helpdesk_delivery_vas_tickets]

delivery_seller_vas_spend_amount:
  title: delivery_seller_vas_spend_amount
  description: "Delivery seller vas spend amount"
  tags: [i4, delivery, vas]
  agg: sum
  numerator: [delivery_seller_vas_spend_amount]

delivery_seller_bonuses_in_vas_spend_amount:
  title: delivery_seller_bonuses_in_vas_spend_amount
  description: "Delivery seller bonuses in vas spend amount"
  tags: [i4, delivery, seller]
  agg: sum
  numerator: [delivery_seller_bonuses_in_vas_spend_amount]

items_with_delivery_soa:
  title: items_with_delivery_soa
  description: "All delviery item closed by SOA"
  tags: [i4, delivery, seller]
  agg: sum
  numerator: [items_with_delivery_soa]

items_with_delivery:
  title: items_with_delivery
  description: "All item with delivery"
  tags: [i4, delivery, seller]
  agg: sum
  numerator: [items_with_delivery]

item_off_delivery:
  title: item_off_delivery
  description: "All item off delivery"
  tags: [i4, delivery, seller]
  agg: sum
  numerator: [item_off_delivery]

delivery_item_view:
  title: delivery_item_view
  description: "Uniq item view of delivery item"
  tags: [i4, delivery, buyer]
  agg: sum
  numerator: [item_view]

delivery_total_item_view:
  title: delivery_total_item_view
  description: "Total item view of delivery item"
  tags: [i4, delivery, buyer]
  agg: sum
  numerator: [total_item_view]

delivery_click:
  title: delivery_click
  description: "Uniq delivery button click"
  tags: [i4, delivery, buyer]
  agg: sum
  numerator: [delivery_click]

total_delivery_click:
  title: total_delivery_click
  description: "Total delivery button click"
  tags: [i4, delivery, buyer]
  agg: sum
  numerator: [total_delivery_click]

delivery_widget:
  title: delivery_widget
  description: "Uniq delivery widget show"
  tags: [i4, delivery, buyer]
  agg: sum
  numerator: [delivery_widget]

total_delivery_widget:
  title: total_delivery_widget
  description: "Total delivery widget show"
  tags: [i4, delivery, buyer]
  agg: sum
  numerator: [total_delivery_widget]

delivery_contact:
  title: delivery_contact
  description: "Uniq delivery contacts"
  tags: [i3, delivery, buyer]
  agg: sum
  numerator: [delivery_contact]

total_delivery_contact:
  title: total_delivery_contact
  description: "Total delivery contacts"
  tags: [i3, delivery, buyer]
  agg: sum
  numerator: [total_delivery_contact]

###############################################################################
# Delivery :: Ratios
###############################################################################

buyer_delivery_in_transit_ratio:
  title: buyer_delivery_in_transit_ratio
  description: "All delivery orders in transit ratio by buyer"
  tags: [i3, delivery, buyer]
  agg: sum
  numerator: [buyer_delivery_orders_in_transit]
  denominator: [buyer_delivery_orders_with_pay]

seller_delivery_in_transit_ratio:
  title: seller_delivery_in_transit_ratio
  description: "All delivery in transit orders ratio by seller"
  tags: [i4, delivery, seller]
  agg: sum
  numerator: [seller_delivery_orders_in_transit]
  denominator: [seller_delivery_orders_with_pay]

delivery_view_delivery_click_ratio:
  title: delivery_view_delivery_click_ratio
  description: "Conversion from delivery item view to delivery button by uniq user"
  tags: [i4, delivery, buyer]
  agg: sum
  numerator: [delivery_click]
  denominator: [item_view]

delivery_total_view_delivery_click_ratio:
  title: delivery_total_view_delivery_click_ratio
  description: "Conversion from delivery item view to delivery button"
  tags: [i4, delivery, buyer]
  agg: sum
  numerator: [total_delivery_click]
  denominator: [total_item_view]

delivery_click_widget_ratio:
  title: delivery_click_widget_ratio
  description: "Conversion from delivery button click to delivery widget by uniq user"
  tags: [i4, delivery, buyer]
  agg: sum
  numerator: [delivery_widget]
  denominator: [delivery_click]

delivery_total_click_widget_ratio:
  title: delivery_total_click_widget_ratio
  description: "Conversion from delivery button click to delivery widget"
  tags: [i4, delivery, buyer]
  agg: sum
  numerator: [total_delivery_widget]
  denominator: [total_delivery_click]

delivery_widget_contact_ratio:
  title: delivery_widget_contact_ratio
  description: "Conversion from delivery widget show to delivery contact by uniq user"
  tags: [i4, delivery, buyer]
  agg: sum
  numerator: [delivery_contact]
  denominator: [delivery_widget]

delivery_total_widget_contact_ratio:
  title: delivery_total_widget_contact_ratio
  description: "Conversion from delivery widget show to delivery contact"
  tags: [i4, delivery, buyer]
  agg: sum
  numerator: [total_delivery_contact]
  denominator: [total_delivery_widget]


 ######  ##     ##  #######  ########  ########       ########  ######## ##    ## ########
##    ## ##     ## ##     ## ##     ##    ##          ##     ## ##       ###   ##    ##
##       ##     ## ##     ## ##     ##    ##          ##     ## ##       ####  ##    ##
 ######  ######### ##     ## ########     ##          ########  ######   ## ## ##    ##
      ## ##     ## ##     ## ##   ##      ##          ##   ##   ##       ##  ####    ##
##    ## ##     ## ##     ## ##    ##     ##          ##    ##  ##       ##   ###    ##
 ######  ##     ##  #######  ##     ##    ##          ##     ## ######## ##    ##    ##

###############################################################################
# Short Rent :: Totals
###############################################################################

booking_created_short_rent:
  title: booking_created_short_rent
  tags: [i4, bx, total]
  numerator: [booking_created_short_rent]
  agg: sum

buyer_str_bookings:
  title: buyer_str_bookings
  description: "All str bookings by buyer"
  tags: [i3, str, buyer]
  agg: sum
  numerator: [buyer_str_bookings]

buyer_str_bookings_paid:
  title: buyer_str_bookings_paid
  description: "All str paid bookings by buyer"
  tags: [i4, str, buyer]
  agg: sum
  numerator: [buyer_str_bookings_paid]

buyer_str_bookings_comfirmed:
  title: buyer_str_bookings_comfirmed
  description: "All str confirmed bookings by buyer"
  tags: [i4, str, buyer]
  agg: sum
  numerator: [buyer_str_bookings_comfirmed]

buyer_str_bookings_expired:
  title: buyer_str_bookings_expired
  description: "All str expired bookings by buyer"
  tags: [i4, str, buyer]
  agg: sum
  numerator: [buyer_str_bookings_expired]

buyer_str_bookings_canceled:
  title: buyer_str_bookings_canceled
  description: "All str canceled bookings for buyer"
  tags: [i4, str, buyer]
  agg: sum
  numerator: [buyer_str_bookings_canceled]

buyer_str_booking_cost:
  title: buyer_str_booking_cost
  description: "All buyer bookings cost, paid/not paid both"
  tags: [i4, str, buyer]
  agg: sum
  numerator: [buyer_str_booking_cost]

buyer_str_paid:
  title: buyer_str_paid
  description: "Money paid for bookings by buyer"
  tags: [i4, str, buyer]
  agg: sum
  numerator: [buyer_str_paid]

buyer_str_deals:
  title: buyer_str_deals
  description: "All str deals by buyer"
  tags: [i4, str, buyer]
  agg: sum
  numerator: [buyer_str_deals]

buyer_str_bookings_voided:
  title: buyer_str_bookings_voided
  description: "All str voided bookings by buyer"
  tags: [i4, str, buyer]
  agg: sum
  numerator: [buyer_str_bookings_voided]

seller_str_bookings:
  title: seller_str_bookings
  description: "All str bookings by seller"
  tags: [i4, str, seller]
  agg: sum
  numerator: [seller_str_bookings]

seller_str_bookings_paid:
  title: seller_str_bookings_paid
  description: "All str paid bookings by seller"
  tags: [i3, str, seller]
  agg: sum
  numerator: [seller_str_bookings_paid]

seller_str_bookings_comfirmed:
  title: seller_str_bookings_comfirmed
  description: "All str confirmed bookings by seller"
  tags: [i4, str, seller]
  agg: sum
  numerator: [seller_str_bookings_comfirmed]

seller_str_bookings_canceled:
  title: seller_str_bookings_canceled
  description: "All str canceled bookings by seller"
  tags: [i4, str, seller]
  agg: sum
  numerator: [seller_str_bookings_canceled]

seller_str_bookings_expired:
  title: seller_str_bookings_expired
  description: "All str expired bookings by seller"
  tags: [i4, str, seller]
  agg: sum
  numerator: [seller_str_bookings_expired]

seller_str_deals:
  title: seller_str_deals
  description: "All str deals by seller"
  tags: [i4, str, seller]
  agg: sum
  numerator: [seller_str_deals]

seller_str_bookings_voided:
  title: seller_str_bookings_voided
  description: "All str voided bookings by seller"
  tags: [i4, str, seller]
  agg: sum
  numerator: [seller_str_bookings_voided]

seller_str_payout_fee:
  title: seller_payout_fee
  description: "Money seller pay avito from booking"
  tags: [i4, str, seller]
  agg: sum
  numerator: [seller_payout_fee]

seller_str_payout_amount:
  title: seller_payout_amount
  description: "Money buyer pay for booking by seller"
  tags: [i4, str, seller]
  agg: sum
  numerator: [seller_payout_amount]

helpdesk_str_tickets:
  title: helpdesk_str_tickets
  description: "Str helpdesk tickets"
  tags: [i4, str]
  agg: sum
  numerator: [helpdesk_str_tickets]

items_with_str:
  title: items_with_str
  description: "All item with str"
  tags: [i4, str, seller]
  agg: sum
  numerator: [items_with_str]

items_with_str_soa:
  title: items_with_str_soa
  description: "All str item closed with SOA"
  tags: [i4, str, seller]
  agg: sum
  numerator: [items_with_str_soa]
  denominator: [seller_str_bookings_paid]

item_off_str:
  title: item_off_str
  description: "All item off str"
  tags: [i4, str, buyer]
  agg: sum
  numerator: [item_off_str]

str_item_view:
  title: str_item_view
  description: "Uniq item view of str item"
  tags: [i4, str, buyer]
  agg: sum
  numerator: [item_view]

str_total_item_view:
  title: str_total_item_view
  description: "Total item view of str item"
  tags: [i4, str, buyer]
  agg: sum
  numerator: [total_item_view]

str_click:
  title: str_click
  description: "Uniq str button click"
  tags: [i4, str, buyer]
  agg: sum
  numerator: [str_click]

total_str_click:
  title: total_str_click
  description: "Total str button click"
  tags: [i4, str, buyer]
  agg: sum
  numerator: [total_str_click]

str_widget:
  title: str_widget
  description: "Uniq str widget show"
  tags: [i4, str, buyer]
  agg: sum
  numerator: [str_widget]

total_str_widget:
  title: total_str_widget
  description: "Total str widget show"
  tags: [i4, str, buyer]
  agg: sum
  numerator: [total_str_widget]

str_contact:
  title: str_contact
  description: "Uniq str contacts"
  tags: [i4, str, buyer]
  agg: sum
  numerator: [str_contact]

total_str_contact:
  title: total_str_contact
  description: "Total str contacts"
  tags: [i4, str, buyer]
  agg: sum
  numerator: [total_str_contact]

###############################################################################
# Short Rent :: Ratios
###############################################################################

buyer_str_confirmed_ratio:
  title: buyer_str_confirmed_ratio
  description: "Conversion from paid to confirmed booking buyer"
  tags: [i4, str, buyer]
  agg: sum
  numerator: [buyer_str_bookings_comfirmed]
  denominator: [buyer_str_bookings_paid]

seller_str_confirmed_ratio:
  title: seller_str_confirmed_ratio
  description: "Conversion from paid to confirmed booking seller"
  tags: [i4, str, seller]
  agg: sum
  numerator: [seller_str_bookings_comfirmed]
  denominator: [seller_str_bookings_paid]

str_view_str_click_ratio:
  title: str_view_str_click_ratio
  description: "Conversion from str item view to str button by uniq user"
  tags: [i4, str, buyer]
  agg: sum
  numerator: [str_click]
  denominator: [item_view]

str_total_view_str_click_ratio:
  title: str_total_view_str_click_ratio
  description: "Conversion from str item view to str button"
  tags: [i4, str, buyer]
  agg: sum
  numerator: [total_str_click]
  denominator: [total_item_view]

str_click_widget_ratio:
  title: str_click_widget_ratio
  description: "Conversion from str button click to str widget by uniq user"
  tags: [i4, str, buyer]
  agg: sum
  numerator: [str_widget]
  denominator: [str_click]

str_total_click_widget_ratio:
  title: str_total_click_widget_ratio
  description: "Conversion from str button click to str widget"
  tags: [i4, str, buyer]
  agg: sum
  numerator: [total_str_widget]
  denominator: [total_str_click]

str_widget_contact_ratio:
  title: str_widget_contact_ratio
  description: "Conversion from str widget show to str contact by uniq user"
  tags: [i4, str, buyer]
  agg: sum
  numerator: [str_contact]
  denominator: [str_widget]

str_total_widget_contact_ratio:
  title: str_total_widget_contact_ratio
  description: "Conversion from str widget show to str contact"
  tags: [i4, str, buyer]
  agg: sum
  numerator: [total_str_contact]
  denominator: [total_str_widget]


 ######   ########   #######  ##      ## ######## ##     ##
##    ##  ##     ## ##     ## ##  ##  ##    ##    ##     ##
##        ##     ## ##     ## ##  ##  ##    ##    ##     ##
##   #### ########  ##     ## ##  ##  ##    ##    #########
##    ##  ##   ##   ##     ## ##  ##  ##    ##    ##     ##
##    ##  ##    ##  ##     ## ##  ##  ##    ##    ##     ##
 ######   ##     ##  #######   ###  ###     ##    ##     ##

###############################################################################
# Growth :: Totals
###############################################################################

contacts_freecat:
  title: contacts_freecat
  tags: [i3, total]
  numerator: [contacts_freecat]
  agg: sum
  description: "contacts in virtual free-item-category"

contacts_per_item_view_freecat:
  title: contacts_per_item_view_freecat
  tags: [i3, ratio]
  agg: sum
  numerator: [contacts_freecat]
  denominator: [item_views_freecat]
  description: "contacts/item_views in virtual free-item-category"

buyers_freecat_daily:
  title: buyers_freecat
  tags: [i3, user]
  numerator: [contacts_freecat]
  agg: proportion
  description: "buyers in virtual free-item-category"

users_item_view_freecat_daily:
  title: users_item_view_freecat
  tags: [i3, user]
  numerator: [item_views_freecat]
  agg: proportion
  description: "item views daily in virtual free-item-category"

phone_views_notfreecat:
  title: phone_views_notfreecat
  tags: [i3, total]
  numerator: [phone_views_notfreecat]
  agg: sum
  description: "phone views not in virtual free-item-category"

contacts_notfreecat:
  title: contacts_notfreecat
  tags: [i3, total]
  numerator: [contacts_notfreecat]
  agg: sum
  description: "contacts not in virtual free-item-category"

buyers_notfreecat_daily:
  title: buyers_notfreecat
  tags: [i3, user]
  numerator: [contacts_notfreecat]
  agg: proportion
  description: "buyers not in virtual free-item-category"

item_views_freecat:
  title: item_views_freecat
  tags: [i3, total]
  numerator: [item_views_freecat]
  agg: sum
  description: "item views in vitrual free-item-category"

phone_views_freecat:
  title: phone_views_freecat
  tags: [i3, total]
  numerator: [phone_views_freecat]
  agg: sum
  description: "phone views in virtual free-item-category"


######## ##    ##  ######
   ##    ###   ## ##    ##
   ##    ####  ## ##
   ##    ## ## ##  ######
   ##    ##  ####       ##
   ##    ##   ### ##    ##
   ##    ##    ##  ######

###############################################################################
# TNS :: Totals
###############################################################################

forgot_password_count:
  numerator: [forgot_password_count]
  agg: sum

password_restore_requests:
  numerator: [password_restore_requests]
  agg: sum

contacts_public_profile_per_unique_user:
  agg: sum
  numerator: [contacts_public_profile]
  denominator: [public_profile_unique_views]

password_restore_request_errors:
  numerator: [password_restore_request_errors]
  agg: sum

password_restore_count:
  numerator: [password_restore_count]
  agg: sum

password_restore_errors:
  numerator: [password_restore_errors]
  agg: sum

sign_in_count:
  numerator: [sign_in_count]
  agg: sum

sign_in_errors:
  numerator: [sign_in_errors]
  agg: sum

public_profile_views:
  numerator: [public_profile_views]
  agg: sum

public_profile_unique_views:
  numerator: [public_profile_unique_views]
  agg: sum

contacts_public_profile:
  numerator: [contacts_public_profile]
  agg: sum

public_profile_active_items_paginations:
  numerator: [public_profile_active_items_paginations]
  agg: sum

public_profile_closed_items_paginations:
  numerator: [public_profile_closed_items_paginations]
  agg: sum

user_enter:
  description: "number of unique cookies with successful authorization/registration/restore, which had authorization start screen (eid=2089)"
  tags: [i2, tns, tns_bulb, enter]
  agg: sum
  numerator: [enter_success]

user_auth:
  description: "number of unique cookies with successful authorization (phone/email/social), which had authorization start screen"
  tags: [i2, tns, tns_bulb, auth, enter]
  agg: sum
  numerator: [auth_success]

user_registration:
  description: "number of unique cookies with successful registration (not social), which had authorization start screen"
  tags: [i2, tns, tns_bulb, reg, enter]
  agg: sum
  numerator: [registration_success]

user_password_restore:
  description: "number of unique cookies with successful password restore, which had restore start screen (including those who's changed platform while restoring by email)"
  tags: [i2, tns, tns_bulb, restore, enter]
  agg: sum
  numerator: [restore_success]
  
abuses:
  title: abuses
  tags: [tns, moderation]
  numerator: [abuses]
  agg: sum

###############################################################################
# TNS :: Ratios
###############################################################################

user_registration_cr:
  title: user_registration_conv
  description: "share of unique cookies with successful registration (not social) among those who had registration start screen"
  tags: [i2, tns, tns_bulb, reg, enter]
  agg: sum
  numerator: [registration_success]
  denominator: [registration_start]

user_password_restore_cr:
  title: user_restore_conv
  description: "share of unique cookies with successful password restore among those who had restore start screen (including those who's changed platform while restoring by email)"
  tags: [i2, tns, tns_bulb, restore, enter]
  agg: sum
  numerator: [restore_success]
  denominator: [restore_start]

user_auth_cr:
  title: user_auth_conv
  description: "share of unique cookies with successful authorization (phone/email/social) among those who had authorization start screen"
  tags: [i2, tns, tns_bulb, auth, enter]
  agg: sum
  numerator: [auth_success]
  denominator: [auth_start]

user_enter_cr:
  title: user_enter_conv
  description: "share of unique cookies with successful authorization/registration/restore among those who had authorization start screen"
  tags: [i0, tns, tns_bulb, auth, enter]
  agg: sum
  numerator: [enter_success]
  denominator: [auth_start]

auth_errors_per_user:
  description: "average number of authorization (phone/email/social) errors per cookie"
  tags: [i3, tns, tns_bulb, auth, enter]
  agg: sum
  numerator: [auth_errors]
  denominator: [auth_start]

registration_errors_per_user:
  description: "average number of registration (not social) errors per cookie"
  tags: [i3, tns, tns_bulb, reg, enter]
  agg: sum
  numerator: [registration_errors]
  denominator: [registration_start]

password_restore_errors_per_user:
  description: "average number of password restore errors per cookie"
  tags: [i4, tns, tns_bulb, restore, enter]
  agg: sum
  numerator: [restore_errors]
  denominator: [restore_start]

enter_errors_per_user:
  description: "average number of authorization/registration/restore errors per cookie"
  tags: [i3, tns, tns_bulb, enter]
  agg: sum
  numerator: [enter_errors]
  denominator: [auth_start]

###############################################################################
# TNS :: User Totals
###############################################################################

password_restore_request_proportion:
  numerator: [password_restore_requests]
  agg: proportion
  description: "1        ,  0"

password_restore_proportion:
  numerator: [password_restore_count]
  agg: proportion

sign_in_proportion:
  numerator: [sign_in_count]
  agg: proportion

public_profile_views_proportion:
  numerator: [public_profile_views]
  agg: proportion

contacts_public_profile_proportion:
  numerator: [contacts_public_profile]
  agg: proportion

public_profile_active_items_paginations_proportion:
  numerator: [public_profile_active_items_paginations]
  agg: proportion

public_profile_closed_tabs_proportion:
  numerator: [public_profile_closed_tabs]
  agg: proportion

public_profile_closed_items_paginations_proportion:
  numerator: [public_profile_closed_items_paginations]
  agg: proportion

user_auth_proportion:
  description: "share of unique cookies with successful authorization (phone/email/social) among test participants"
  tags: [i2, tns, tns_bulb, auth, enter]
  agg: proportion
  numerator: [auth_success]

user_registration_proportion:
  description: "share of unique cookies with successful registration (not social) among test participants"
  tags: [i2, tns, tns_bulb, reg, enter]
  agg: proportion
  numerator: [registration_success]

user_password_restore_proportion:
  description: "share of unique cookies with successful password restore among test participants"
  tags: [i2, tns, tns_bulb, restore, enter]
  agg: proportion
  numerator: [restore_success]

user_enter_proportion:
  description: "share of unique cookies with successful authorization/registration/restore among test participants"
  tags: [i1, tns, tns_bulb, enter]
  agg: proportion
  numerator: [enter_success]

registration_start_proportion:
  description: "share of unique cookies with registration start screen among test participants"
  tags: [i2, tns, tns_bulb, reg, enter]
  agg: proportion
  numerator: [registration_start]

enter_start_proportion:
  description: "share of unique cookies with authorization start screen among test participants"
  tags: [critical, tns, tns_bulb, enter]
  agg: proportion
  numerator: [auth_start]

restore_start_proportion:
  description: "share of unique cookies with password restore start screen among test participants"
  tags: [i2, tns, tns_bulb, restore, enter]
  agg: proportion
  numerator: [restore_start]


 ######  ######## ##       ##       ######## ########
##    ## ##       ##       ##       ##       ##     ##
##       ##       ##       ##       ##       ##     ##
 ######  ######   ##       ##       ######   ########
      ## ##       ##       ##       ##       ##   ##
##    ## ##       ##       ##       ##       ##    ##
 ######  ######## ######## ######## ######## ##     ##

###############################################################################
# Seller :: Totals
###############################################################################

items_added:
  tags: [critical, sx, total, item_add]
  numerator: [items_added]
  agg: sum
  description: "Items started for paticipant_type='cookie'"

items_add_started:
  tags: [i4, sx, total, item_add]
  numerator: [items_add_started]
  agg: sum
  description: "Items add started for paticipant_type='cookie'"

items_started_net:
  title: items_started_net
  tags: [sx, item_add]
  numerator: [items_started_net]
  agg: sum
  description: "Items created, activated (paid) and allowed by moderation"

items_reactivated_net:
  title: items_reactivated_net
  tags: [sx, reactivation]
  numerator: [items_reactivated_net]
  agg: sum
  description: "Items reactivated and allowed by moderation"

new_items_blocked_or_rejected:
  title: new_items_blocked_or_rejected
  tags: [sx]
  numerator: [new_items_blocked, new_items_rejected]
  agg: sum
  description: "New items blocked or rejected by moderation"

reactivated_items_rejected:
  title: reactivated_items_rejected
  tags: [i2, sx, reactivation, moderation]
  numerator: [reactivated_items_rejected]
  agg: sum
  description: "Reactivated items rejected by moderation"

items_sold_onavito:
  title: items_sold_onavito
  tags: [sx, liquidity]
  numerator: [items_sold_onavito]
  agg: sum
  description: "Items closed with reason Sold on Avito"

items_sold_onavito_start_date:
  title: items_sold_onavito_start_date
  tags: [i1, user, sx, liquidity]
  numerator: [items_sold_onavito]
  agg: sum
  description: "Items closed with reason Sold on Avito for items created after exposure"

items_closed_no_answer:
  title: items_closed_no_answer
  tags: [sx, liquidity]
  numerator: [items_closed_no_answer]
  agg: sum
  description: "Items closed without answer by platform of closing"

items_closed_with_answer:
  title: items_closed_with_answer
  tags: [sx, liquidity]
  numerator: [items_closed_with_answer]
  agg: sum
  description: "Items closed with answer by platform of closing"

items_reactivated_by_ttl_net:
  title: items_reactivated_by_ttl_net
  tags: [sx, reactivation]
  numerator: [items_reactivated_by_ttl_net]
  agg: sum
  description: "Items reactivated after TTL (expiration) and allowed by moderation"

items_closed_by_user:
  description: "Items closed by user"
  tags: [sx, liquidity]
  agg: sum
  numerator: [items_closed_by_user]

active_items:
  description: "Active items"
  tags: [sx]
  agg: sum
  numerator: [active_items]

seller_deals:
  description: "Seller deals"
  tags: [sx]
  agg: sum
  numerator: [deals]

seller_contacts:
  description: "Seller contacts"
  tags: [sx, liquidity]
  agg: sum
  numerator: [contacts]

seller_contacts_start_date:
  description: "Seller contacts for items created after exposure"
  tags: [sx, liquidity]
  agg: sum
  numerator: [contacts]

vas_amount_net:
  description: "Vas amount without bonuses paid by seller"
  tags: [sx, monetization]
  agg: sum
  numerator: [vas_amount_net]

vas_amount_net_start_date:
  description: "Vas amount without bonuses paid by seller for items created after exposure"
  tags: [sx, monetization]
  agg: sum
  numerator: [vas_amount_net]

lf_amount_net:
  description: "Lf amount without bonuses paid by seller"
  tags: [sx, monetization]
  agg: sum
  numerator: [lf_amount_net]

lf_amount_net_start_date:
  description: "Lf amount without bonuses paid by seller for items created after exposure"
  tags: [sx, monetization]
  agg: sum
  numerator: [lf_amount_net]

items_allowed:
  description: "Items allowed by moderation"
  tags: [sx, item_add, moderation]
  agg: sum
  numerator: [items_allowed]

items_allowed_start_date:
  description: "Items created after exposure and allowed by moderation"
  tags: [sx, item_add, moderation]
  agg: sum
  numerator: [items_allowed]

items_blocked_rejected:
  description: "Blocked or rejected items"
  tags: [sx, moderation]
  agg: sum
  numerator: [items_blocked_rejected]

items_blocked_rejected_start_date:
  description: "Blocked or rejected items for items created after exposure"
  tags: [sx, moderation]
  agg: sum
  numerator: [items_blocked_rejected]

item_edits:
  description: "Items edits"
  tags: [sx, item_edit]
  agg: sum
  numerator: [item_edits]

item_edits_start_date:
  description: "Items edits"
  tags: [sx, item_edit]
  agg: sum
  numerator: [item_edits]

seller_favorites_added:
  description: "Favorites add"
  tags: [sx, liquidity]
  agg: sum
  numerator: [favorites_add]

seller_favorites_added_start_date:
  description: "Favorites add for items created after exposure"
  tags: [sx, liquidity]
  agg: sum
  numerator: [favorites_add]

seller_favorites_removed:
  description: "Favorites removed"
  tags: [sx, liquidity]
  agg: sum
  numerator: [favorites_removed]

seller_favorites_removed_start_date:
  description: "Favorites removed for items created after exposure"
  tags: [sx, liquidity]
  agg: sum
  numerator: [favorites_removed]

item_chains_started:
  title: items_add_started
  description: "Items add started"
  tags: [sx, item_add]
  agg: sum
  numerator: [item_chains_started]

###############################################################################
# Seller :: Ratios
###############################################################################

items_added_per_items_add_started:
  title: items_added_per_items_add_started
  tags: [i4, sx, ratio, item_add]
  agg: sum
  numerator: [items_added]
  denominator: [items_add_started]

seller_contacts_per_items_started_net_start_date:
  description: "Seller contacts for items created after exposure per item"
  tags: [sx, liquidity, ratio]
  agg: sum
  numerator: [contacts]
  denominator: [items_started_net]

items_sold_onavito_per_items_started_net_start_date:
  description: "Items closed with reason Sold on Avito for items created after exposure per item"
  tags: [sx, liquidity, ratio]
  agg: sum
  numerator: [items_sold_onavito]
  denominator: [items_started_net]

items_closed_by_user_per_items_started_net_start_date:
  description: "Items closed by user for items created after exposure per item"
  tags: [sx, liquidity, ratio]
  agg: sum
  numerator: [items_closed_by_user]
  denominator: [items_started_net]

seller_favorites_added_per_items_started_net_start_date:
  description: "Favorites add for items created after exposure per item"
  tags: [sx, liquidity, ratio]
  agg: sum
  numerator: [favorites_add]
  denominator: [items_started_net]

item_edits_per_items_started_net_start_date:
  tags: [sx, item_edit, ratio]
  agg: sum
  numerator: [item_edits]
  denominator: [items_started_net]

###############################################################################
# Seller :: User Totals
###############################################################################

sellers_daily:
  title: cookies_item_started
  tags: [i4, sx, user, item_add]
  numerator: [items_added]
  agg: proportion
  description: "Cookies item started"

users_item_add_started:
  title: cookies_item_add_started
  tags: [i4, sx, item_add]
  numerator: [items_add_started]
  agg: proportion
  description: "Cookies item add started"

items_started_net_conversion:
  title: users_item_started_net
  tags: [sx, item_add]
  numerator: [items_started_net]
  agg: proportion
  description: "Users created and activated (paid) items allowed by moderation"

items_reactivated_net_conversion:
  title: users_item_reactivated_net
  tags: [sx, reactivation]
  numerator: [items_reactivated_net]
  agg: proportion
  description: "Users reactivated items allowed by moderation"

new_items_blocked_or_rejected_conversion:
  title: users_new_item_blocked_or_rejected
  tags: [sx]
  numerator: [new_items_blocked, new_items_rejected]
  agg: proportion
  description: "Users created blocked or rejected by moderation items"

reactivated_items_rejected_conversion:
  title: users_reactivated_item_rejected
  tags: [i2, user, sx, moderation, reactivation]
  numerator: [reactivated_items_rejected]
  agg: proportion
  description: "Users reactivated items blocked or rejected by moderation afterwards"

items_sold_onavito_conversion:
  title: users_item_sold_onavito
  tags: [sx, liquidity]
  numerator: [items_sold_onavito]
  agg: proportion
  description: "Users closed items with reason Sold on Avito"

items_reactivated_by_ttl_net_conversion:
  title: items_reactivated_by_ttl_net_conversion
  tags: [sx, reactivation]
  numerator: [items_reactivated_by_ttl_net]
  agg: proportion
  description: "Users reactivated items after TTL (expiration) allowed by moderation afterwards"

users_item_closed_no_answer:
  tags: [sx, liquidity]
  numerator: [items_closed_no_answer]
  agg: proportion
  description: "Users who closed items without answer by platforn of closing"

users_item_closed_with_answer:
  title: users_item_closed_with_answer
  tags: [sx, liquidity]
  numerator: [items_closed_with_answer]
  agg: proportion
  description: "Users who closed items with answer by platform of closing"

users_item_closed_by_user:
  description: "Users who closed items"
  tags: [sx, liquidity]
  agg: proportion
  numerator: [items_closed_by_user]

users_active_items:
  description: "Users with active items"
  tags: [sx]
  agg: proportion
  numerator: [active_items]

sellers_with_contacts:
  description: "Sellers with contacted items"
  tags: [sx, liquidity]
  agg: proportion
  numerator: [contacts]

sellers_with_contacts_start_date:
  description: "Sellers with contacted items created after exposure"
  tags: [sx, liquidity]
  agg: proportion
  numerator: [contacts]

users_vas:
  description: "Users applied VAS"
  tags: [sx, monetization]
  agg: proportion
  numerator: [vas_amount_net]

users_vas_start_date:
  description: "Users applied VAS to items created after exposure"
  tags: [sx, monetization]
  agg: proportion
  numerator: [vas_amount_net]

users_lf:
  description: "Users paid LF"
  tags: [sx, monetization]
  agg: proportion
  numerator: [lf_amount_net]

users_lf_start_date:
  description: "Users paid LF to new items"
  tags: [sx, monetization]
  agg: proportion
  numerator: [lf_amount_net]

users_item_allowed:
  description: "Users with items allowed by moderation"
  tags: [sx, item_add, moderation]
  agg: proportion
  numerator: [items_allowed]

users_item_allowed_start_date:
  description: "Users with items created after exposure and allowed by moderation"
  tags: [sx, item_add, moderation]
  agg: proportion
  numerator: [items_allowed]

users_item_blocked_rejected:
  description: "Users with blocked or rejected items"
  tags: [sx, moderation]
  agg: proportion
  numerator: [items_blocked_rejected]

users_item_blocked_rejected_start_date:
  description: "Users with blocked or rejected items created after exposure"
  tags: [sx, moderation]
  agg: proportion
  numerator: [items_blocked_rejected]

users_item_edit:
  description: "Users edited items"
  tags: [sx, item_edit]
  agg: proportion
  numerator: [item_edits]

users_item_edit_start_date:
  description: "Users edited items created after exposure"
  tags: [sx, item_edit]
  agg: proportion
  numerator: [item_edits]

users_item_chain_started:
  description: "Users started item add"
  tags: [sx, item_add]
  agg: proportion
  numerator: [item_chains_started]

sellers_favorite_added:
  description: "Sellers with items added to favorites"
  tags: [sx, liquidity]
  agg: proportion
  numerator: [favorites_add]

sellers_favorite_added_start_date:
  description: "Sellers with items created after exposure and added to favorites"
  tags: [sx, liquidity]
  agg: proportion
  numerator: [favorites_add]

sellers_favorite_removed:
  description: "Sellers with items removed from favorites"
  tags: [sx, liquidity]
  agg: proportion
  numerator: [favorites_removed]

sellers_favorite_removed_start_date:
  description: "Sellers with items created after exposure and removed from favorites"
  tags: [sx, liquidity]
  agg: proportion
  numerator: [favorites_removed]

##     ## ##    ## ########
###   ### ###   ##      ##
#### #### ####  ##     ##
## ### ## ## ## ##    ##
##     ## ##  ####   ##
##     ## ##   ###  ##
##     ## ##    ## ########

###############################################################################
# MNZ :: Totals
###############################################################################

listings_single_paid:
  numerator: [listings_single_paid]
  agg: sum

lf_revenue:
  title: lf_revenue
  description: "Listing fee revenue total recognized with bonuses"
  tags: [lf]
  agg: sum
  numerator: [lf_revenue]

lf_transactions:
  title: lf_transactions
  description: "Listing fee transactions total (single and lf from package)"
  tags: [lf]
  agg: sum
  numerator: [lf_transactions]

lf_packages_item_add:
  title: lf_packages
  description: "Num of lf packages bought on item add"
  tags: [lf]
  agg: sum
  numerator: [lf_packs]

lf_revenue_single:
  title: lf_revenue_single
  description: "Listing fee revenue single on item add"
  tags: [lf]
  agg: sum
  numerator: [lf_revenue_single]

lf_transactions_single:
  title: lf_transactions_single
  description: "Listing fee single transactions"
  tags: [lf]
  agg: sum
  numerator: [lf_transactions_single]

express_cv_started:
  description: "Created express cv"
  tags: [cv]
  numerator: [express_cv_started]
  agg: sum

express_cv_started_net:
  description: "Created express cv allowed by moderation"
  tags: [cv]
  numerator: [express_cv_started_net]
  agg: sum

express_cv_published:
  description: "Created express cv which were not hide from employers"
  tags: [cv]
  numerator: [express_cv_published]
  agg: sum

express_cv_views:
  description: "Express cv views by platform of creation"
  tags: [cv]
  numerator: [express_cv_views]
  agg: sum

contacts_paid_express_cv:
  description: "Express cv paid contacts by platform of creation"
  tags: [cv]
  numerator: [contacts_paid_express_cv]
  agg: sum

contacts_paid_amount_express_cv:
  description: "Express cv paid contacts amount by platform of creation"
  tags: [cv]
  numerator: [contacts_paid_amount_express_cv]
  agg: sum

###############################################################################
# MNZ :: Ratios
###############################################################################

payment_method_pv_per_listing_type_pv:
  agg: sum
  numerator: [pages_payment_method]
  denominator: [pages_listing_type]

success_payments_per_listing_type_pv:
  agg: sum
  numerator: [pages_success_payment]
  denominator: [pages_listing_type]

payment_page_per_lf_show_block:
  title: payment_page_per_lf_show
  description: "Conversion from lf block show to payment page"
  tags: [lf]
  agg: sum
  numerator: [lf_payment_page_events]
  denominator: [lf_block_show_events]

item_add_success_per_lf_show_block:
  title: item_add_per_lf_show
  description: "Conversion from lf block show to success item add"
  tags: [lf]
  agg: sum
  numerator: [final_page_events]
  denominator: [lf_block_show_events]

express_cv_form_open_item_add_conversion:
  description: "Conversion from express cv form open to item add"
  tags: [cv]
  agg: sum
  numerator: [express_cv_started]
  denominator: [express_cv_form_open]

express_cv_allowed_conversion:
  description: "Conversion from created express cv to allowed by moderation"
  tags: [cv]
  agg: sum
  numerator: [express_cv_started_net]
  denominator: [express_cv_started]


########  #### ##       ##       #### ##    ##  ######
##     ##  ##  ##       ##        ##  ###   ## ##    ##
##     ##  ##  ##       ##        ##  ####  ## ##
########   ##  ##       ##        ##  ## ## ## ##   ####
##     ##  ##  ##       ##        ##  ##  #### ##    ##
##     ##  ##  ##       ##        ##  ##   ### ##    ##
########  #### ######## ######## #### ##    ##  ######

###############################################################################
# Billing :: Totals
###############################################################################

payment_method_page:
  title: payment_method_page
  tags: [payments]
  numerator: [payment_method_page]
  agg: sum
  description: "Number of started payment sessions"

payment_method_choice:
  title: payment_method_choice
  tags: [payments]
  numerator: [payment_method_choice]
  agg: sum
  description: "Number of payment sessions with selected payment method"

successful_payment:
  title: successful_payment
  tags: [payments]
  numerator: [successful_payment]
  agg: sum
  description: "Number of successful payment sessions"

payment_method_page_cv:
  title: payment_method_page_CV
  tags: [payments]
  numerator: [payment_method_page_CV]
  agg: sum
  description: "Number of started CV payment sessions"

payment_method_choice_cv:
  title: payment_method_choice_CV
  tags: [payments]
  numerator: [payment_method_choice_CV]
  agg: sum
  description: "Number of CV payment sessions with selected payment method"

successful_payment_cv:
  title: successful_payment_CV
  tags: [payments]
  numerator: [successful_payment_CV]
  agg: sum
  description: "Number of successful CV payment sessions"

###############################################################################
# Billing :: Ratios
###############################################################################

successful_payment_share:
  description: "Share of successful payments step3/step1"
  tags: [payments]
  tags: [payments, m42]
  agg: sum
  numerator: [successful_payment]
  denominator: [payment_method_page]

successful_payment_share_proportion:
  description: "Share of successful payments step3/step1 (proportion)"
  tags: [payments]
  agg: proportion
  numerator: [successful_payment]
  denominator: [payment_method_page]

selected_payment_method_share:
  description: "Share of payment sessions with selected payment method step2/step1"
  tags: [payments]
  agg: sum
  numerator: [payment_method_choice]
  denominator: [payment_method_page]

selected_payment_method_share_proportion:
  description: "Share of payment sessions with selected payment method step2/step1 (proportion)"
  tags: [payments]
  agg: proportion
  numerator: [payment_method_choice]
  denominator: [payment_method_page]

successful_payment_share_cv:
  description: "Share of successful payments CV step3/step1"
  tags: [payments]
  agg: sum
  numerator: [successful_payment_CV]
  denominator: [payment_method_page_CV]

successful_payment_share_proportion_cv:
  description: "Share of successful payments CV step3/step1 (proportion)"
  tags: [payments]
  agg: proportion
  numerator: [successful_payment_CV]
  denominator: [payment_method_page_CV]

selected_payment_method_share_cv:
  description: "Share of CV payment sessions with selected payment method step2/step1"
  tags: [payments]
  agg: sum
  numerator: [payment_method_choice_CV]
  denominator: [payment_method_page_CV]

selected_payment_method_share_proportion_cv:
  description: "Share of CV payment sessions with selected payment method step2/step1 (proportion)"
  tags: [payments]
  agg: proportion
  numerator: [payment_method_choice_CV]
  denominator: [payment_method_page_CV]

main_payment_methods_share:
  description: "Share of successful payments by cards and SBOL"
  tags: [payments]
  agg: sum
  numerator: [successful_payment_card, successful_payment_SBOL]
  denominator: [successful_payment]


 ######   #######   ######         ######   #######  ########  ########
##    ## ##     ## ##    ##       ##    ## ##     ## ##     ## ##
##              ## ##             ##       ##     ## ##     ## ##
##        #######  ##             ##       ##     ## ########  ######
##       ##        ##             ##       ##     ## ##   ##   ##
##    ## ##        ##    ##       ##    ## ##     ## ##    ##  ##
 ######  #########  ######         ######   #######  ##     ## ########

###############################################################################
# C2C Core :: Totals
###############################################################################

new_listers:
  title: new_listers
  tags: [i1]
  numerator: [new_listers]
  agg: sum
  description: "Users who started their first item in logical category. Additive across logical categories"

active_listers:
  title: active_listers
  tags: [i0, m42, tree]
  numerator: [active_listers]
  agg: sum
  description: "Users who have at least 1 active item in a logical category. Additive across logical_category"

activated_listers:
  title: activated_listers
  tags: [i1, m42, tree]
  numerator: [activated_listers]
  agg: sum
  description: "Active listers in (logical_category X user_segment) that were not active yesterday. Additive across logical_category, user_segment"

activated_listers_changed_segment:
  title: activated_listers_changed_segment
  tags: [i2, m42, tree]
  numerator: [activated_listers_changed_segment]
  agg: sum
  description: "Active listers in (logical_category X user_segment) that had a different user_segment in this logical_category yesterday. Additive across logical_category, user_segment"

returned_listers:
  title: returned_listers
  tags: [i2, m42, tree]
  numerator: [returned_listers]
  agg: sum
  description: "Activated listers in (logical_category X user_segment) that aren't new listers. Additive across logical categories"

deactivated_listers:
  title: deactivated_listers
  tags: [i2, m42, tree]
  numerator: [deactivated_listers]
  agg: sum
  description: "Users who were active listers in (logical_category X user_segment) yesterday but aren't active today. Additive across logical_category, user_segment"

deactivated_listers_voluntary:
  title: deactivated_listers_voluntary
  tags: [i2, m42, tree]
  numerator: [deactivated_listers_voluntary]
  agg: sum
  description: "Listers that were deactivated because their last active item was closed by user. Additive across logical_category, user_segment"

deactivated_listers_involuntary:
  title: deactivated_listers_involuntary
  tags: [i2, m42, tree]
  numerator: [deactivated_listers_involuntary]
  agg: sum
  description: "Listers that were deactivated because their last active item was blocked/rejected. Additive across logical_category, user_segment"

deactivated_listers_changed_segment:
  title: deactivated_listers_changed_segment
  tags: [i2, m42, tree]
  numerator: [deactivated_listers_changed_segment]
  agg: sum
  description: "Listers that were deactivated because they changed user_segment. Additive across logical_category, user_segment"

new_buyers:
  title: new_buyers
  tags: [i1, m42, tree]
  numerator: [new_buyers]
  agg: sum
  description: "Cookies that made their first contact in a logical_category. Additive across logical_category"

returned_buyers:
  title: returned_buyers
  tags: [i1, m42, tree]
  numerator: [returned_buyers]
  agg: sum
  description: "Cookies that made contact in a logical_category that are not new buyers. Additive across logical_category"
